(function(){var u=document.getElementsByName("Main")[0].contentWindow.document;var j=u.getElementsByTagName("table");var f=[];var k="";var t,a,o,s,r,m,q;var n=new Date()-3600*24*1000;var d=0,h=0,g=0,c=0,b=0;var p={"2015-06-22":false,"2015-09-03":false,"2015-09-04":false,"2015-09-06":true,"2015-10-01":false,"2015-10-02":false,"2015-10-05":false,"2015-10-06":false,"2015-10-07":false,"2015-10-10":true};function e(l){var i=l.split("-");return new Date(Number(i[0]),Number(i[1])-1,Number(i[2]))}for(s=0,r=j.length;s<r;s++){t=j[s];if(t.getAttribute("className")==="listAC"||t.getAttribute("class")==="listAC"){a={};a["date"]=t.rows[2].cells[0].childNodes[0].href.split("?")[1].replace(/\D*/,"");a["content"]=t.rows[1].cells[0].innerHTML;a["leave"]=t.rows[2].cells[0].firstChild.innerText;o=a["content"].split("~");if(o.length>1){a["hours"]=(new Date(2000,1,1,o[1].split(":")[0],o[1].split(":")[1])-new Date(2000,1,1,o[0].split(":")[0],o[0].split(":")[1]))/1000/3600-1}else{a["hours"]=NaN}if(isNaN(a.hours)){a["hours"]=(a["leave"]==="无"?0:8)}f.push(a)}}for(s=0,r=f.length;s<r;s++){a=f[s];if(e(a.date)>n){break}if(p[a.date]!==undefined){a["isWorkingDay"]=p[a.date]}else{a["isWorkingDay"]=e(a.date).getDay()!==0&&e(a.date).getDay()!==6}d+=a.hours;if(a.hours>0){a.isWorkingDay?g++:c++}if(a.isWorkingDay){h++;if(a.hours>=10){b++}}}q=d/h;if(q>=10){m="鞠躬精粹，死而后已！ ★★★★★"}else{if(q>=9.5){m="优秀劳模！ ★★★★☆"}else{if(q>=9){m="热爱工作！ ★★★☆☆"}else{if(q>=8.5){m="工作努力！ ★★☆☆☆"}else{if(q>=8){m="合格员工！ ★☆☆☆☆"}else{m="小心被扣钱！ ☆☆☆☆☆"}}}}}k+="累计出勤 "+(g+c)+" 天"+(c>0?"(其中节假日加班 "+c+" 天)":"")+"，共 "+d.toFixed(2)+" 工时。\n\n"+"平均每个工作日 "+q.toFixed(2)+" 工时。\n\n"+"工作日加班2小时以上 "+b+" 天，可领餐贴 "+b*20+" 元。\n\n"+"对您的评价："+m;alert(k)})();