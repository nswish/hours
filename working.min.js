(function(){var m=document.getElementsByName("Main")[0].contentWindow.document;var n=m.getElementsByTagName("table");var a=[];var o,c,k,g,d;var b=new Date()-3600*24*1000;var j=0,h=0,p=0;var e={"2015-06-22":false,"2015-09-03":false,"2015-09-04":false,"2015-09-06":true,"2015-10-01":false,"2015-10-02":false,"2015-10-05":false,"2015-10-06":false,"2015-10-07":false,"2015-10-10":true};function f(l){var i=l.split("-");return new Date(Number(i[0]),Number(i[1])-1,Number(i[2]))}for(g=0,d=n.length;g<d;g++){o=n[g];if(o.getAttribute("className")==="listAC"||o.getAttribute("class")==="listAC"){c={};c["date"]=o.rows[2].cells[0].childNodes[0].href.split("?")[1].replace(/\D*/,"");c["content"]=o.rows[1].cells[0].innerHTML;c["leave"]=o.rows[2].cells[0].firstChild.innerText;if(c["content"]==="无刷卡记录"){c["hours"]=(c["leave"]==="无"?0:8)}else{k=c["content"].split("~");c["hours"]=(new Date(2000,1,1,k[1].split(":")[0],k[1].split(":")[1])-new Date(2000,1,1,k[0].split(":")[0],k[0].split(":")[1]))/1000/3600-1}a.push(c)}}for(g=0,d=a.length;g<d;g++){c=a[g];if(f(c.date)>b){break}if(e[c.date]!==undefined){c["isWorkingDay"]=e[c.date]}else{c["isWorkingDay"]=f(c.date).getDay()!==0&&f(c.date).getDay()!==6}if(c.isWorkingDay){j+=c.hours;h++;if(c.hours>10){p++}}}alert("累计出勤 "+h+" 天，"+j.toFixed(2)+" 工时，每日平均 "+(j/h).toFixed(2)+" 工时。\n\n"+"其中加班2小时以上 "+p+" 天，可领餐贴 "+p*20+" 元。")})();